
@model OnlineCourseSystem.Domain.Model.Tasks.QuizTask


<div class="question-wrap">
    <div>
        <h2 class="quiz-title">@Model.Name</h2>
    </div>
    
    <div class="form-quiz" name="quiz">
        <input id="taskId-quiz-@Model.Id" type="hidden" value="@Model.Id" />
        <div id="result-quiz-@Model.Id"></div>
        <div class="question-paragraph">
            <p>@Model.Question</p>
        </div>
        @foreach (var variant in Model.VariantOfAnswers)
        {
        <div class="quiz-option">
            <input type="radio" name="variant" value="@variant.Text" />@variant.Text<br />
        </div>
        }
        <button id="send-answer-quiz-@Model.Id" class="counter_form_button question-button question-button-send">Send answer</button>
    </div>

    <div class="nav-buttons">
        <button class="counter_form_button question-button move-back-btn">Back</button>
        <button class="counter_form_button question-button move-next-btn">Next</button>
    </div>
</div>

<script>
    $(document).ready(function() {
        $.ajax({
                url: "/User/CourseStatistic/CheckCompleteQuiz",
                type: "GET",
                data: {
                    taskId: $("#taskId-quiz-@Model.Id").val(),
                }
            }).
            done(function (res) {
                
                if (res.isCompleted === true) {
                    $("#send-answer-quiz-@Model.Id").prop("disabled", true); 
                    $("#result-quiz-@Model.Id").html(`<div class="question-paragraph"><p>Correct! Well Done</p></div>`);
                }
                console.log($("#send-answer-quiz"));
            });
    });


    $("#send-answer-quiz").click(function() {
        $.ajax({
                url: "/User/CourseStatistic/Quiz",
                type: "GET",
                data: {
                    answer:$("input[type='radio'][name='variant']:checked").val(),
                    taskId: $("#taskId-quiz-@Model.Id").val(),
                }
            }).
            done(function (res) {
                $("#send-answer-@Model.Id").prop("disabled", true); 
                if (res.rezult === true) {
                    $("#result-quiz-@Model.Id").html(`<div class="question-paragraph"><p>Correct! Well Done</p></div>`);
                } else {
                    $("#result-quiz-@Model.Id").html(`<div class="question-paragraph"><p>Unfortunately, You are wrong</p></div>`);
                }
            });
    });
</script>